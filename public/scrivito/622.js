"use strict";(("undefined"!=typeof self?self:global).webpackChunk=("undefined"!=typeof self?self:global).webpackChunk||[]).push([[622,599],{4992:(t,e,i)=>{i.d(e,{$:()=>p,Z:()=>u});var r=i(9853),n=i(2757),o=Object.defineProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,l=(t,e,i)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,d=(t,e)=>{for(var i in e||(e={}))s.call(e,i)&&l(t,i,e[i]);if(a)for(var i of a(e))c.call(e,i)&&l(t,i,e[i]);return t};function u(t,e,i){return(0,r.Y3)((()=>g((r=>{r[t]={content:e,parentElementId:i}})))),()=>(0,r.Y3)((()=>g((e=>{delete e[t]}))))}function p(){const t=m();return Object.keys(t).map((e=>{const i=parseInt(e,10);return d({elementId:i},t[i])}))}const f=(0,n.JH)();function g(t){const e=d({},m());t(e),f.set(e)}function m(){return f.get()||{}}},4145:(t,e,i)=>{i.d(e,{so:()=>s,st:()=>c,ui:()=>a});var r=i(9853),n=i(6664);const o={};function a(t,e){o[t]=e}function s(t){delete o[t]}function c(t){return o[t]?l.get(t).get():null}const l=new n.X2({loadElement:t=>({stream:new r.fU((e=>{const i=()=>{const i=o[t];e.next(i?function(t){const{left:e,top:i,width:r,height:n}=t.getBoundingClientRect();return{x:e+window.pageXOffset,y:i+window.pageYOffset,width:r,height:n}}(i):null)};i();const r=window.setInterval(i,1e3);return()=>window.clearInterval(r)}))})})},8599:(t,e,i)=>{i.r(e),i.d(e,{Editor:()=>st,Team:()=>at,editorRegistrationFor:()=>d,getCachedValidationReportEntries:()=>T,getDataStackVariables:()=>X,getDataVariablesFor:()=>Q,getGlobalDataVariables:()=>Y,installDndHandler:()=>o,installScrollHandler:()=>h,openContentBrowser:()=>m,registerEditor:()=>l,reloadIfContextChangesFrom:()=>A,runValidationsFor:()=>V,setModeIndicators:()=>f,titleForBasicWidget:()=>j,validationResultsFor:()=>x});var r=i(4712),n=i(9853);function o(){const t=(0,n.Me)();t.addEventListener("dragover",(t=>function(t){t.dataTransfer.dropEffect="move",t.preventDefault();const e={x:t.pageX,y:t.pageY};(0,r.K)().dragTo(e)}(t))),t.addEventListener("drop",(()=>{(0,r.K)().drop()}))}var a=i(2757);let s=0,c={};function l(t){const e=(s++,s.toString());c[e]=t;const i=u.get()||[];u.set([...i,e])}function d({type:t,tag:e}){const i=u.get();if(i){const r=i.find((i=>c[i]&&c[i].canEdit({type:t,tag:e})));if(r){return{id:r,editorClass:c[r]}}}}const u=(0,a.JH)();(0,n.rj)((function(){s=0,c={},u.clear()}));var p=i(6993);function f(){const t=(0,n.Me)().body;t.classList.add("scrivito_editing_active"),(0,p.DG)()&&t.setAttribute("data-scrivito-editing",""),(0,p.rl)()&&t.setAttribute("data-scrivito-comparison","")}var g=i(8493);function m(t={}){return(0,r.K)().openContentBrowser((0,g.f)(t))}const v=30,b=25;function h(){(0,n.Me)().addEventListener("dragover",(t=>{const e=t.clientY,i=(0,n.bY)(),r=(0,n.XO)();r>0&&e<v?(0,n.X5)(i,r-b):(0,n.aZ)()>r+(0,n.WS)()&&e>(0,n.WS)()-v&&(0,n.X5)(i,r+b)}))}var w=i(384),y=i(105);function j(t){return function(t){var e;const i=t.objClass(),r=null==(e=(0,w.x)(i))?void 0:e.titleForContent;if("function"==typeof r)try{return r((0,y.pz)(t))}catch(t){(0,n.a6)(t)}}(t)||(e=t.objClass(),(null==(i=(0,w.x)(e))?void 0:i.title)||(0,n.G8)(e));var e,i}var O=i(8273);const C=function(t){return(null==t?0:t.length)?(0,O.Z)(t,Infinity):[]};var E=i(8142),_=i(6664),M=i(9880),k=Object.defineProperty,D=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,I=(t,e,i)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,N=(t,e)=>{for(var i in e||(e={}))P.call(e,i)&&I(t,i,e[i]);if(D)for(var i of D(e))S.call(e,i)&&I(t,i,e[i]);return t};const W={error:0,warning:1,info:2},$=(0,n.PJ)("validationResultsFor",[["model",n.pC.union([M.Bt,M.l9])],["attributeName",n.pC.String]],{docPermalink:"js-sdk/validationResultsFor"});function x(t,e,...i){return $(t,e,...i),T(t._scrivitoPrivateContent).filter((t=>(0,n.iS)(t)&&t.attributeName===e)).sort((({severity:t},{severity:e})=>W[t]-W[e])).map((t=>({message:t.message,severity:t.severity})))}const T=(0,_.wV)([],(t=>t instanceof M.Jj?t.id():`${t.obj().id()}/${t.id()}`),V);function V(t){var e;const i=t instanceof M.Jj?t:t.obj();if(!i.isEdited()&&!i.isNew())return[];const r=t.objClass(),o=null==(e=(0,w.x)(r))?void 0:e.validations;if(!o)return[];const a=(0,y.pz)(t);return C(o.map((t=>(0,E.eK)(t)?function(t,e){return B(`Please check validations for the model ${e._scrivitoPrivateContent.objClass()}. `,t,e).map(F)}(t,a):function(t,e){const[i,...r]=t,o=e._scrivitoPrivateContent.objClass();if(!function(t){return!(0,n.mb)(t)||R(t)}(i))return(0,n.a6)(new n.ir(`Found an attribute validation callback for the system attribute ${i} of the model ${o}. Attribute validations can only be used for custom attributes and for the system attributes "_language" and "_permalink". For other system attributes please use class-based validations. Visit ${(0,n.m0)("js-sdk/provideEditingConfig#validations")} for more information.`)),[];let a;if(R(i)){const t=e._scrivitoPrivateContent;if(!(t instanceof M.Jj))return[];switch(i){case"_language":a=t.language();break;case"_permalink":a=t.permalink()}}else{const t=y.V_.basicFieldFor(e,i);if(!t)return[];a=(0,y.pz)(t.get())}const s=N({name:i},(l=e,l._scrivitoPrivateContent instanceof M.Jj?{content:e,obj:e}:{content:e,widget:e})),c=`Please check validations for the attribute ${i} of the model ${o}. `;var l;return C(r.map((t=>{var e;const r=(0,E.np)(t),n=(0,E.tj)(t)&&(null==(e=t[0])?void 0:e.severity);return B(c,r,a,s).map((t=>({attributeName:i,message:t.message,severity:n||t.severity||"error"})))})))}(t,a))))}function F(t){return{message:t.message,severity:t.severity||"error"}}function R(t){return["_language","_permalink"].includes(t)}function B(t,e,...i){let r;try{r=e(...i)}catch(t){return(0,n.a6)(t),[]}return r?"string"==typeof r?[{message:r}]:Array.isArray(r)&&r.every((t=>"string"==typeof t))?r.map((t=>({message:t}))):function(t){return!!t&&"object"==typeof t&&!!t.message&&(e=t.severity,"string"==typeof e&&-1!==E.bI.indexOf(e));var e}(r)?[r]:((0,n.a6)(new n.ir(`A validation must return a validation result or a falsy value. ${t}Visit ${(0,n.m0)("js-sdk/provideEditingConfig#validations")} for more information.`)),[]):[]}function A(t){(0,_.DU)((()=>(0,r.K)().currentEditingContext())).subscribe((e=>{const i=null==e?void 0:e.windowName;i&&i!==t&&((0,n.sy)(i),(0,n.H5)())}))}var K=i(785),G=i(9528),H=Object.defineProperty,J=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,U=(t,e,i)=>e in t?H(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,z=(t,e)=>{for(var i in e||(e={}))Z.call(e,i)&&U(t,i,e[i]);if(J)for(var i of J(e))L.call(e,i)&&U(t,i,e[i]);return t};const Y=(0,_.wV)(void 0,(()=>{const t=function(){const t={};return(0,G.d$)().forEach((e=>{const i=e.dataClassName(),r=(0,w.x)(i),o=it(null==r?void 0:r.title,i),a=null==r?void 0:r.attributes;if(a)Object.entries(a).forEach((([r,{title:n}])=>t[et(i,r)]=tt(o,it(n,r),e.get(r))));else{const r=e.getExternalData();r&&Object.entries(r).forEach((([e,r])=>t[et(i,e)]=tt(o,(0,n.G8)(e),r)))}})),t}();return Object.keys(t).length?t:void 0}));const X=(0,_.wV)(void 0,(function(t){return t.filter(G.Fv).map((({_class:t,_id:e})=>`${t}:${e}`)).join()}),(function(t){const e=t.filter(G.Fv).map((({_class:t,_id:e})=>{var i;return null==(i=(0,G.KT)(t))?void 0:i.get(e)})).filter((t=>!!t)).map(q).filter((t=>!!t));return 0===e.length?void 0:Object.assign({},...e)}));function Q(t,e){const i=rt(t);if(i)return function(t,e){return(0,K.Z)(t,((t,i)=>z({title:t},function(t,e){if(!e)return;const i=e[t];return void 0===i?void 0:{value:i}}(i,e))))}(i,e)}function q(t){let e,i;const r=t.obj();r&&(e=r?(0,G.Gc)((0,y.bM)(r)):void 0,i=e?Object.keys(e):[]);const o={},a=t.dataClassName(),s=(0,w.x)(a),c=it(null==s?void 0:s.title,a),l=null==s?void 0:s.attributes;if(l)Object.entries(l).forEach((([e,{title:r}])=>{i&&!i.includes(e)||(o[et(a,e)]=tt(c,it(r,e),t.get(e)))}));else if(e)Object.entries(e).forEach((([t,e])=>o[et(a,t)]=tt(c,(0,n.G8)(t),e)));else if(t instanceof G.HP){const e=t.getExternalData();e&&Object.entries(e).forEach((([t,e])=>o[et(a,t)]=tt(c,(0,n.G8)(t),e)))}return o}function tt(t,e,i){return{dataClassTitle:t,title:e,value:"string"==typeof i?i:""}}function et(t,e){return`${t}.${e}`}function it(t,e){return t||(0,n.G8)(e)}function rt(t){var e;const i=t.getContainer(),r=null==(e=(0,w.x)(i.objClass()))?void 0:e.attributeDataContext;if(r){const e=r[t.name()];return"string"==typeof e?function(t,e){var i;const r=t.getContainer().get(e,"datalocator"),n=r.class();if(null===n)return;const o=null==(i=(0,w.x)(n))?void 0:i.attributes;if(!o)return;return(0,K.Z)(o,(({title:t},e)=>it(t,e)))}(t,e):e}if(i instanceof M.E8){const t=i.obj().fieldContainingWidget(i);if(t)return rt(t)}}var nt=i(7879),ot=i(9099);class at{constructor(t){this.teamData=t}id(){return this.teamData.id}name(){return this.teamData.name}description(){return this.teamData.description||""}}class st extends ot.n{constructor(t,e){super(t),this.teamsData=e}teams(){return this.teamsData.map((t=>new at(t)))}authToken(t){return(0,nt.Q)(t)||""}}},1622:(t,e,i)=>{i.r(e),i.d(e,{AttributeValueWithEditing:()=>R,ChildListTagWithEditing:()=>At,WidgetPlaceholder:()=>ee,WidgetTagWithEditing:()=>Dt,WidgetlistPlaceholder:()=>Ut});var r=i(4073),n=i(8083),o=i(6993),a=i(8599),s=i(2250),c=i(5408),l=i(6519),d=i(5648),u=i(5037),p=i(6601),f=i(9853),g=i(6664),m=i(349),v=i(8926);var b,h=i(2757),w=Object.defineProperty,y=Object.defineProperties,j=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,_=(t,e,i)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,M=(t,e)=>{for(var i in e||(e={}))C.call(e,i)&&_(t,i,e[i]);if(O)for(var i of O(e))E.call(e,i)&&_(t,i,e[i]);return t},k=(t,e)=>y(t,j(e));const D=(0,l.$j)((function(t){const e=(0,m.uv)(),i=null==e?void 0:e.placeholders,n=(0,a.getGlobalDataVariables)(),o=(null==e?void 0:e.dataStack)?(0,a.getDataStackVariables)(e.dataStack):void 0;return r.createElement(P,k(M({},t),{placeholders:i,dataStackVariables:o,globalDataVariables:n}))})),P=(0,l.$j)(((b=class extends r.Component{constructor(t){super(t),this.stateChangeCausedByEditor=new f.AY,this.field=this.props.field,this.state={domMode:"None"};const e=this.props.editorClass;if(e){const t={getContent:this.getContent.bind(this),options:this.options.bind(this),setContent:this.setContent.bind(this),setDomMode:this.setDomMode.bind(this),validObjClasses:this.validObjClasses.bind(this)};this.editor=new e({controller:t})}}componentDidMount(){if(!this.editor)return;const t=this.editor;t.editorWillBeActivated();const e=(0,h.M5)((()=>this.getContent()),(()=>{this.stateChangeCausedByEditor.current()||t.contentDidChange()}));this.unsubscribe=e.unsubscribe,"Replace"===this.state.domMode&&this.editorDomWasMounted()}componentDidUpdate(t,e){var i;const r=e.domMode,n=this.state.domMode;r!==n&&("Replace"===n?this.editorDomWasMounted():this.editorDomWasUnmounted()),t.globalDataVariables===this.props.globalDataVariables&&t.dataStackVariables===this.props.dataStackVariables||null==(i=this.editor)||i.contentDidChange()}componentWillUnmount(){this.editor&&this.editor.editorWillBeDeactivated(),this.unsubscribe&&this.unsubscribe(),this.unregisterScrollTarget&&this.unregisterScrollTarget()}render(){if("Replace"===this.state.domMode){const t=this.props.customProps,{children:e,dangerouslySetInnerHTML:i}=t,n=((t,e)=>{var i={};for(var r in t)C.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&O)for(var r of O(t))e.indexOf(r)<0&&E.call(t,r)&&(i[r]=t[r]);return i})(t,["children","dangerouslySetInnerHTML"]),o=t=>{t.stopPropagation(),t.preventDefault()};return r.createElement(this.props.tag,k(M({},n),{ref:t=>{this.editorComponent=t},onClick:o}))}let t;const e=this.editor;return e&&e.onClick&&(t=t=>{t.stopPropagation(),t.preventDefault(),e.onClick()}),r.createElement(s.gH,{elementCallback:t=>{this.editorComponent=t},widgetProps:this.props.widgetProps,customProps:this.props.customProps,field:this.props.field,key:this.state.domMode,tag:this.props.tag,onClick:t})}editorDomWasMounted(){if(this.editor&&this.editorComponent){const t=(0,d.findDOMNode)(this.editorComponent);this.editor.editorDomWasMounted(t);const e=this.props.field.obj().id(),i=this.props.field.name();this.unregisterScrollTarget=(0,p.a)({objId:e,attributeName:i},t)}}editorDomWasUnmounted(){this.editor&&this.editor.editorDomWasUnmounted()}setDomMode(t){this.setState({domMode:t})}getContent(){return(0,g.IE)((()=>{if("html"===this.field.type()){const e=this.field.get();return t=e,(0,v.q)(t,{preserveObjId:!0})}var t;return this.field.get()})).result}setContent(t){this.stateChangeCausedByEditor.runWith(!0,(()=>this.field.update(t)))}options(){const t=M({},(0,u.k)(this.field.getContainer().objClass(),this.field.name(),this.field.type())),e=(0,a.getDataVariablesFor)(this.field,this.props.placeholders),{dataStackVariables:i,globalDataVariables:r}=this.props;return(i||e||r)&&(t.dataVariables=M(M(M({},e),i),r)),t}validObjClasses(){return this.field.validClasses()}}).displayName="Scrivito.ContentTag.Editor",b));var S=i(9880);var I=Object.defineProperty,N=Object.defineProperties,W=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,V=(t,e,i)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,F=(t,e)=>{for(var i in e||(e={}))x.call(e,i)&&V(t,i,e[i]);if($)for(var i of $(e))T.call(e,i)&&V(t,i,e[i]);return t};const R=(0,l.$j)((function(t){const e=(0,c.M)(),{field:i,tag:l}=t;if(!(0,o.DG)()||!(0,n.r)(i.obj().id()))return r.createElement(s.gH,F({},t));if(e){const e=(0,a.editorRegistrationFor)({type:i.type(),tag:l});if(e){const{id:n,editorClass:o}=e,a=[l,(u=i.getContainer(),u instanceof S.Jj?u.id():`${u.obj().id()}|${u.id()}`),i.name(),n].join("|");return r.createElement(D,(d=F({},t),N(d,W({key:a,editorClass:o}))))}}var d,u;return r.createElement(s.gH,F({},t))}));var B=i(1021),A=i(3218),K=i(101),G=i(4712),H=i(4992),J=i(4145),Z=Object.defineProperty,L=Object.defineProperties,U=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,Q=(t,e,i)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,q=(t,e)=>{for(var i in e||(e={}))Y.call(e,i)&&Q(t,i,e[i]);if(z)for(var i of z(e))X.call(e,i)&&Q(t,i,e[i]);return t},tt=(t,e)=>L(t,U(e));function et(t){var e;return(e=class extends r.Component{constructor(t){super(t),this.registeredElement=new ot}render(){return r.createElement(t,tt(q({},this.props),{registeredElement:this.registeredElement}))}}).displayName=`${(0,l.r0)(t)}WithRegisteredElement`,e}function it(t,e){var i;return(i=class extends r.Component{constructor(t){super(t),this.registeredElement=new ot}componentDidMount(){this.unregisterContentZone=(0,H.Z)(this.registeredElement.id(),t(this.props),this.context)}componentWillUnmount(){this.unregisterContentZone&&this.unregisterContentZone()}render(){return r.createElement(rt.Provider,{value:this.registeredElement.id()},r.createElement(e,tt(q({},this.props),{registeredElement:this.registeredElement})))}}).displayName=`${(0,l.r0)(e)}WithContentZone`,i.contextType=rt,i}const rt=r.createContext(void 0),nt=class t{static generateId(){return this.currentId++,this.currentId}constructor(){this.elementId=t.generateId()}id(){return this.elementId}set(t){t?(0,J.ui)(this.elementId,t):(0,J.so)(this.elementId)}};nt.currentId=0;let ot=nt;var at;const st=et((0,l.$j)(((at=class extends r.Component{constructor(t){super(t),this.onClick=this.onClick.bind(this)}render(){const{markerClassName:t,tooltip:e,disableMenu:i}=function(t){switch(t.modification){case"new":return{tooltip:lt("widget_is_new")};case"edited":switch(t.placementModification){case"new":return{markerClassName:"scrivito_widget_moved_icon",tooltip:lt("widget_is_edited_and_dragged_here")};case"deleted":return{markerClassName:"scrivito_widget_moved_icon",tooltip:lt("widget_is_edited_and_dragged_away"),disableMenu:!0};default:return{tooltip:lt("widget_is_edited")}}case"deleted":return{tooltip:lt("widget_is_deleted")};default:switch(t.placementModification){case"new":return{tooltip:lt("widget_is_dragged_here")};case"deleted":return{tooltip:lt("widget_is_dragged_away")}}}}(this.props.widgetModification),n=i?void 0:this.onClick;return r.createElement("span",{ref:t=>this.props.registeredElement.set(t),className:`scrivito_editing_marker ${null!=t?t:""} ${n?"":"scrivito_disabled"}`,title:e,onClick:n,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut},r.createElement("i",{className:`scrivito_icon ${ct(this.props.widgetModification)}`}),r.createElement("span",{className:"scrivito_editing_marker_title"},(0,a.titleForBasicWidget)(this.props.widget)))}onClick(t){t.preventDefault(),t.stopPropagation(),(0,G.K)().showWidgetMenu(this.props.registeredElement.id(),this.props.widget.obj().id(),this.props.widget.id(),{objSpaceId:this.props.widget.objSpaceId()})}}).displayName="Scrivito.ContentTag.ComparisonMenuMarker",at)));function ct(t){switch(t.modification){case"new":return"scrivito_icon_inv_plus";case"edited":return"scrivito_icon_edited";case"deleted":return"scrivito_icon_trash";default:return"scrivito_icon_moved"}}function lt(t){return function(t){if(A.k)return A.k.translate(t)}(`widget_marker.${t}`)}var dt;const ut=et((0,l.$j)(((dt=class extends r.Component{constructor(t){super(t),this.onClick=this.onClick.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragEnd=this.onDragEnd.bind(this)}render(){return r.createElement("span",{ref:t=>this.props.registeredElement.set(t),className:"scrivito_editing_marker",title:this.props.tooltip,onClick:this.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,draggable:!0,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},r.createElement("i",{className:"scrivito_icon"}),r.createElement("span",{className:"scrivito_editing_marker_title"},(0,a.titleForBasicWidget)(this.props.widget)))}onClick(t){t.preventDefault(),t.stopPropagation(),(0,G.K)().showWidgetMenu(this.props.registeredElement.id(),this.props.widget.obj().id(),this.props.widget.id(),{objSpaceId:this.props.widget.objSpaceId()})}onDragStart({dataTransfer:t,target:e}){t.effectAllowed="move",t.setData("text/plain",e.id),(0,G.K)().startDrag(this.props.widget.obj().id(),this.props.widget.id()),this.props.setDragState(!0)}onDragEnd(){(0,G.K)().endDrag(),this.props.setDragState(!1)}}).displayName="Scrivito.ContentTag.EditingMenuMarker",dt)));function pt(t){return t.map((t=>(0,f.Kw)(t.message)[0])).join("\n")}const ft=(0,l.$j)((function({insertWidget:t,onMouseOut:e,onMouseOver:i,position:n,widget:o}){return r.createElement("span",{className:`scrivito_option_marker scrivito_${n}`,onClick:function(e){e.preventDefault(),e.stopPropagation(),t(o,n)},onMouseOver:i,onMouseOut:e},r.createElement("i",{className:"scrivito_icon scrivito_icon_marker_plus"}))}));let gt,mt=0,vt={};var bt=i(105),ht=Object.defineProperty,wt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,jt=Object.getOwnPropertySymbols,Ot=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,Et=(t,e,i)=>e in t?ht(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,_t=(t,e)=>{for(var i in e||(e={}))Ot.call(e,i)&&Et(t,i,e[i]);if(jt)for(var i of jt(e))Ct.call(e,i)&&Et(t,i,e[i]);return t},Mt=(t,e)=>wt(t,yt(e)),kt=(t,e)=>{var i={};for(var r in t)Ot.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&jt)for(var r of jt(t))e.indexOf(r)<0&&Ct.call(t,r)&&(i[r]=t[r]);return i};const Dt=t=>r.createElement(K.R.Consumer,null,(e=>r.createElement(St,_t(_t({},e),t)))),Pt=(0,l.$j)((function(t){var e;const i=(0,c.M)(),[s,l]=r.useState(!1),[d,u]=r.useState(!1),[f,g]=r.useState(!0),[m,v]=r.useState(!1),[b,h]=r.useState(!1),w=r.useRef(),y=r.useRef(),j=r.useRef(),O=r.useRef(!1),C=r.useRef(),E=null==(e=bt.V_.forInstance((0,bt.pz)(t.widget)))?void 0:e.attributes();let _=!1,M=!1;if(E){const t=Object.keys(E);_=t.some((t=>{const[e]=E[t];return"widget"===e||"widgetlist"===e})),M=t.some((t=>"data"===t&&"datalocator"===E[t][0]))}if(r.useEffect((()=>{const e=C.current;e&&(y.current=(0,p.a)({objId:t.widget.obj().id(),widgetId:t.widget.id()},e,(()=>{v(!0),h((t=>!t))})))}),[t.widget]),r.useEffect((()=>(w.current=function(t){const e=mt;return vt[e]=t,mt+=1,e}({onFocus:()=>{l(!0),g(!1),$(),_||(j.current=window.setTimeout((()=>{O.current||g(!0)}),1e3))},onBlur:()=>l(!1)}),()=>{var t;$(),t=w.current,delete vt[t],y.current&&y.current()})),[_]),(0,o.DG)()){const e=t.widget.obj();if((0,n.r)(e.id()))return i?function(){const e=(0,a.getCachedValidationReportEntries)(t.widget);return r.createElement(t.tag,_t(Mt(_t({},P()),{ref:e=>{t.registeredElement.set(e),C.current=e},className:S(),style:I(),onMouseOver:N,onMouseOut:W,children:[r.createElement(ut,{key:"menuMarker",widget:t.widget,tooltip:pt(e),setDragState:u,onMouseOver:x,onMouseOut:T}),...r.Children.toArray(t.children),V("top"),V("bottom")]}),It({validationResults:e,isStructureWidget:_,hasStandardDatalocator:M})))}():k()}if((0,o.rl)()){const e=function(){const e=t.widget.modification((0,B.N)()),i=t.placementModification;if(e)return{modification:e,placementModification:i};if(i)return{placementModification:i}}();if(e&&!function({modification:t,placementModification:e}){return"deleted"===t&&!e}(e))return function(e){return r.createElement(t.tag,_t(Mt(_t({},P()),{ref:C,className:S(),style:I(),onMouseOver:N,onMouseOut:W,children:[r.createElement(st,{key:"menuMarker",widget:t.widget,widgetModification:e,onMouseOver:x,onMouseOut:T}),...r.Children.toArray(t.children)]}),It({modification:e.modification||e.placementModification,isStructureWidget:_,hasStandardDatalocator:M})))}(e)}return k();function k(){return r.createElement(t.tag,Mt(_t({},D()),{ref:C}))}function D(){const e=t,{tag:i,widget:r,placementModification:n,fieldType:o,registeredElement:a}=e;return kt(e,["tag","widget","placementModification","fieldType","registeredElement"])}function P(){const t=D(),{className:e,style:i}=t;return kt(t,["className","style"])}function S(){let e=t.className||"";const i=s&&!f;(0,o.DG)()&&i&&(e+=" scrivito_active scrivito_entered");const r="deleted"===t.placementModification||"deleted"===t.widget.modification((0,B.N)());return(0,o.rl)()&&r&&(e+=" scrivito_modification_opacity"),m&&(e+=b?" scrivito_wiggle_odd":" scrivito_wiggle_even"),e}function I(){return d?t.style?Mt(_t({},t.style),{opacity:.5}):{opacity:.5}:t.style}function N(t){t.stopPropagation(),function(t){gt=t;const e=vt[gt];e&&e.onFocus()}(w.current)}function W(t){t.stopPropagation(),function(t){if(t===gt){const e=vt[t];e&&e.onBlur()}}(w.current)}function $(){j.current&&window.clearTimeout(j.current)}function x(){O.current=!0}function T(){O.current=!1}function V(e){return"widget"===t.fieldType?null:r.createElement(ft,{key:`optionMarker-${e}`,position:e,widget:t.widget,insertWidget:Nt,onMouseOver:x,onMouseOut:T})}})),St=it((({widget:t})=>{if(!t)throw new f.AQ;return{type:"widget",objId:t.obj().id(),widgetId:t.id()}}),(t=>{var e=t,{widget:i}=e,n=kt(e,["widget"]);if(!i)throw new f.Ix("Detected inappropriate placing of Scrivito.WidgetTag: It is intended to be used exclusively as top-level element inside a Widget component.");return r.createElement(Pt,_t({widget:i},n))}));function It({modification:t,validationResults:e,isStructureWidget:i,hasStandardDatalocator:r}){const n={"data-scrivito-private-widget":"true","data-scrivito-private-dropzone":"true"};i&&(n["data-scrivito-private-structure-widget"]="true"),i&&r&&(n["data-scrivito-private-data-widget"]="true"),t&&(n["data-scrivito-private-widget-modification"]=t);return["error","warning","info"].forEach((t=>{var i,r;i=t,(r=e)&&r.some((t=>t.severity===i))&&(n[`data-scrivito-private-widget-validation-${t}`]="true")})),n}function Nt(t,e){A.k.insertWidget(t.obj().id(),t.id(),e)}function Wt({parent:t,registeredElement:e}){return r.createElement("span",{ref:t=>e.set(t),className:"scrivito_editing_marker",onClick:function(i){i.preventDefault(),i.stopPropagation(),(0,G.K)().showChildListMenu(e.id(),t.id())}},r.createElement("i",{className:"scrivito_icon"}),r.createElement("span",{className:"scrivito_editing_marker_title"},t.objClass()))}Wt.displayName="Scrivito.ChildListTag.MenuMarker";const $t=et((0,l.$j)(Wt));var xt=Object.defineProperty,Tt=Object.getOwnPropertySymbols,Vt=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable,Rt=(t,e,i)=>e in t?xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,Bt=(t,e)=>{for(var i in e||(e={}))Vt.call(e,i)&&Rt(t,i,e[i]);if(Tt)for(var i of Tt(e))Ft.call(e,i)&&Rt(t,i,e[i]);return t};const At=(0,l.$j)((function(t){const e=(0,c.M)(),[i,n]=r.useState(!1),a=t,{basicParent:s,tag:l}=a,d=((t,e)=>{var i={};for(var r in t)Vt.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&Tt)for(var r of Tt(t))e.indexOf(r)<0&&Ft.call(t,r)&&(i[r]=t[r]);return i})(a,["basicParent","tag"]),u=(0,o.DG)()&&e,p=r.Children.toArray(t.children),f=u?[r.createElement($t,{parent:s,key:"menuMarker"}),...p]:p,g=u&&{onMouseOver:v,onMouseOut:b,"data-scrivito-private-child-list-path":!0,className:i?`scrivito_active scrivito_entered ${null!=(m=t.className)?m:""}`:t.className};var m;return r.createElement(l,Bt({},Bt(Bt({},g),d)),f);function v(t){t.stopPropagation(),n(!0)}function b(t){t.stopPropagation(),n(!1)}}));var Kt,Gt=Object.defineProperty,Ht=Object.getOwnPropertySymbols,Jt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Lt=(t,e,i)=>e in t?Gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;const Ut=it((t=>((t,e)=>{for(var i in e||(e={}))Jt.call(e,i)&&Lt(t,i,e[i]);if(Ht)for(var i of Ht(e))Zt.call(e,i)&&Lt(t,i,e[i]);return t})({type:"widgetlist"},zt(t.field))),(0,l.$j)(((Kt=class extends r.Component{constructor(t){super(t),this.onClick=this.onClick.bind(this)}render(){return r.createElement("div",{ref:t=>{this.widgetlistPlaceholder=t,this.props.registeredElement.set(t)},className:"scrivito_empty_widget_field","data-scrivito-private-dropzone":"true",onClick:this.onClick})}onClick(t){if(t.preventDefault(),t.stopPropagation(),this.widgetlistPlaceholder){const{objId:e,widgetId:i,attributeName:r}=zt(this.props.field);(0,G.K)().showWidgetlistMenu(this.props.registeredElement.id(),(0,f.jB)(t,this.widgetlistPlaceholder),e,r,i)}}}).displayName="Scrivito.ContentTag.WidgetlistPlaceholder",Kt)));function zt(t){const e=t.getContainer();return e instanceof S.Jj?{objId:e.id(),attributeName:t.name()}:{objId:e.obj().id(),widgetId:e.id(),attributeName:t.name()}}var Yt=Object.defineProperty,Xt=Object.getOwnPropertySymbols,Qt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable,te=(t,e,i)=>e in t?Yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;const ee=it((({field:t})=>((t,e)=>{for(var i in e||(e={}))Qt.call(e,i)&&te(t,i,e[i]);if(Xt)for(var i of Xt(e))qt.call(e,i)&&te(t,i,e[i]);return t})({type:"widgetField"},ie(t))),(0,l.$j)((function({field:t,registeredElement:e}){const[i,n]=r.useState(null);return r.createElement("div",{ref:t=>{n(t),e.set(t)},className:"scrivito_empty_widget_field","data-scrivito-private-dropzone":"true",onClick:function(r){if(r.preventDefault(),r.stopPropagation(),i){const{objId:n,widgetId:o,attributeName:a}=ie(t);(0,G.K)().showWidgetlistMenu(e.id(),(0,f.jB)(r,i),n,a,o)}}})})));function ie(t){const e=t.getContainer();return e instanceof S.Jj?{objId:e.id(),attributeName:t.name()}:{objId:e.obj().id(),widgetId:e.id(),attributeName:t.name()}}}}]);